[general]
# Path to the AWSLogs agent's state file. Agent uses this file to maintain
# client side state across its executions.
state_file = /var/awslogs/state/agent-state

## Each log file is defined in its own section. The section name doesn't
## matter as long as its unique within this file.

[<%= @stack[:name]-syslog %>]
datetime_format = [%Y-%m-%d %H:%M:%S]
log_group_name = syslog
log_stream_name = <%= @stack[:name].gsub(' ','_') %>-<%= @instance[:hostname] %>
file = /var/log/syslog

[php7.0-fpm.log]
file = /var/log/php7.0-fpm.log
log_group_name = php7.0-fpm.log
log_stream_name = <%= @stack[:name].gsub(' ','_') %>-<%= @instance[:hostname] %>
datetime_format = %b %d %H:%M:%S

<% @apps.each do |app| %>
[<%= app[:shortname] %>.access.log]
file = /var/log/nginx/<%= app[:shortname] %>.access.log
log_group_name = <%= app[:shortname] %>.access.log
log_stream_name = <%= @stack[:name].gsub(' ','_') %>-<%= @instance[:hostname] %>
datetime_format = %b %d %H:%M:%S

[<%= app[:shortname] %>.error.log]
file = /var/log/nginx/<%= app[:shortname] %>.error.log
log_group_name = <%= app[:shortname] %>.error.log
log_stream_name = <%= @stack[:name].gsub(' ','_') %>-<%= @instance[:hostname] %>
datetime_format = %b %d %H:%M:%S
<% end %>

[<%= @stack[:name]-cwlogs %>]
datetime_format = [%Y-%m-%d %H:%M:%S]
log_group_name = <%= @stack[:name].gsub(' ','_') %>-cwlogs
log_stream_name = <%= @instance[:hostname] %>
file = <%= node[:cwlogs][:logfile] %>
